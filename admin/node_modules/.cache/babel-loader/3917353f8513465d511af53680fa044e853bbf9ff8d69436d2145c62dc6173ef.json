{"ast":null,"code":"import { resolveComponent as _resolveComponent, createVNode as _createVNode, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, normalizeClass as _normalizeClass, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createBlock as _createBlock, withCtx as _withCtx, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nimport _imports_0 from '@/assets/img/dash.svg';\nconst _withScopeId = n => (_pushScopeId(\"data-v-114ee624\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"dashboard\"\n};\nconst _hoisted_2 = {\n  class: \"header\"\n};\nconst _hoisted_3 = {\n  class: \"header__select\"\n};\nconst _hoisted_4 = {\n  class: \"heading header__heading\"\n};\nconst _hoisted_5 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"dash__button__title\"\n}, \"Дашборд\", -1 /* HOISTED */));\nconst _hoisted_6 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"img\", {\n  src: _imports_0,\n  alt: \"\"\n}, null, -1 /* HOISTED */));\nconst _hoisted_7 = [_hoisted_5, _hoisted_6];\nconst _hoisted_8 = {\n  class: \"user\"\n};\nconst _hoisted_9 = {\n  class: \"username\"\n};\nconst _hoisted_10 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"line\"\n}, null, -1 /* HOISTED */));\nconst _hoisted_11 = {\n  class: \"id\"\n};\nconst _hoisted_12 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"line\"\n}, null, -1 /* HOISTED */));\nconst _hoisted_13 = {\n  class: \"date\"\n};\nconst _hoisted_14 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"line\"\n}, null, -1 /* HOISTED */));\nconst _hoisted_15 = {\n  class: \"passage\"\n};\nconst _hoisted_16 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"p\", null, \"Время прохождения: \", -1 /* HOISTED */));\nconst _hoisted_17 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"span\", {\n  class: \"slash\"\n}, \" / \", -1 /* HOISTED */));\nconst _hoisted_18 = {\n  class: \"passage__test\"\n};\nconst _hoisted_19 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"hr\", null, null, -1 /* HOISTED */));\nconst _hoisted_20 = {\n  class: \"results__button\"\n};\nconst _hoisted_21 = {\n  class: \"results__valid\"\n};\nconst _hoisted_22 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"h1\", null, \"Сохранить изменения\", -1 /* HOISTED */));\n\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_y_left_arrow_button = _resolveComponent(\"y-left-arrow-button\");\n  const _component_y_results_tabel_item = _resolveComponent(\"y-results-tabel-item\");\n  const _component_y_results_tabel = _resolveComponent(\"y-results-tabel\");\n  const _component_y_cool_button = _resolveComponent(\"y-cool-button\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"header\", _hoisted_2, [_createElementVNode(\"div\", _hoisted_3, [_createVNode(_component_y_left_arrow_button, {\n    onClick: _cache[0] || (_cache[0] = $event => _ctx.$emit('close'))\n  }), _createElementVNode(\"h1\", _hoisted_4, _toDisplayString($options.block.block_title), 1 /* TEXT */)]), _createElementVNode(\"div\", {\n    onClick: _cache[1] || (_cache[1] = (...args) => $options.openClientDash && $options.openClientDash(...args)),\n    class: \"dash__button\"\n  }, _hoisted_7)]), _createElementVNode(\"div\", _hoisted_8, [_createElementVNode(\"div\", _hoisted_9, _toDisplayString($options.block.user.login || 'no username'), 1 /* TEXT */), _hoisted_10, _createElementVNode(\"div\", _hoisted_11, _toDisplayString($options.block.user.jetBotId || 'no user id'), 1 /* TEXT */), _hoisted_12, _createElementVNode(\"div\", _hoisted_13, _toDisplayString($options.formattedDate), 1 /* TEXT */), _hoisted_14, _createElementVNode(\"div\", _hoisted_15, [_hoisted_16, _createElementVNode(\"p\", {\n    class: _normalizeClass([\"passage__user\", {\n      'passage__user_bad': !$data.isTimeValid\n    }])\n  }, _toDisplayString($data.timeOnPass), 3 /* TEXT, CLASS */), _hoisted_17, _createElementVNode(\"p\", _hoisted_18, _toDisplayString($data.time), 1 /* TEXT */)])]), _hoisted_19, _createElementVNode(\"div\", _hoisted_20, [_createVNode(_component_y_results_tabel, null, {\n    default: _withCtx(() => [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.metrics, metric => {\n      return _openBlock(), _createBlock(_component_y_results_tabel_item, {\n        id: metric.metric_id,\n        value: metric.value,\n        modelValue: metric.value,\n        \"onUpdate:modelValue\": $event => metric.value = $event,\n        modelModifiers: {\n          number: true\n        }\n      }, null, 8 /* PROPS */, [\"id\", \"value\", \"modelValue\", \"onUpdate:modelValue\"]);\n    }), 256 /* UNKEYED_FRAGMENT */))]),\n\n    _: 1 /* STABLE */\n  }), _createElementVNode(\"div\", _hoisted_21, [_createElementVNode(\"div\", {\n    onClick: _cache[2] || (_cache[2] = $event => $data.approved = !$data.approved),\n    class: _normalizeClass([\"elipce\", {\n      'elipse__bad': !$data.approved\n    }])\n  }, null, 2 /* CLASS */), _createElementVNode(\"p\", null, \"Результаты \" + _toDisplayString($data.approved ? \"\" : \"не\") + \" валидны\", 1 /* TEXT */)]), _createVNode(_component_y_cool_button, {\n    onClick: $options.updateBlock\n  }, {\n    default: _withCtx(() => [_hoisted_22]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"onClick\"])])]);\n}","map":{"version":3,"mappings":";OAUeA,UAA2B;;;EATnCC,KAAK,EAAC;AAAW;;EACZA,KAAK,EAAC;AAAQ;;EACfA,KAAK,EAAC;AAAgB;;EAErBA,KAAK,EAAC;AAAyB;gEAIjCC,oBAA8C;EAAzCD,KAAK,EAAC;AAAqB,GAAC,SAAO;gEACxCC,oBAAwC;EAAnCC,GAA2B,EAA3BH,UAA2B;EAACI,GAAG,EAAC;;oBADrCC,UAA8C,EAC9CC,UAAwC;;EAGzCL,KAAK,EAAC;AAAM;;EACVA,KAAK,EAAC;AAAU;iEACrBC,oBAAwB;EAAnBD,KAAK,EAAC;AAAM;;EACZA,KAAK,EAAC;AAAI;iEACfC,oBAAwB;EAAnBD,KAAK,EAAC;AAAM;;EACZA,KAAK,EAAC;AAAM;iEACjBC,oBAAwB;EAAnBD,KAAK,EAAC;AAAM;;EACZA,KAAK,EAAC;AAAS;iEAClBC,oBAA0B,WAAvB,qBAAmB;iEAEtBA,oBACK;EADCD,KAAK,EAAC;AAAO,GAAC,KACtB;;EAAUA,KAAK,EAAC;AAAe;iEAGjCC,oBAAI;;EACCD,KAAK,EAAC;AAAiB;;EASnBA,KAAK,EAAC;AAAgB;iEAOOC,oBAA4B,YAAxB,qBAAmB;;;;;;;uBA3C/DK,oBA8CM,OA9CNC,UA8CM,GA7CJN,oBAUS,UAVTO,UAUS,GATPP,oBAGM,OAHNQ,UAGM,GAFJC,aAA+CC;IAAzBC,OAAK,sCAAEC,UAAK;MAClCZ,oBAAgE,MAAhEa,UAAgE,mBAAzBC,cAAK,CAACC,WAAW,oBAGxDf,oBAGM;IAHAW,OAAK,yCAAEG,2DAAc;IAAEf,KAAK,EAAC;oBAKvCC,oBAaM,OAbNgB,UAaM,GAZJhB,oBAAmE,OAAnEiB,UAAmE,mBAA1CH,cAAK,CAACI,IAAI,CAACC,KAAK,mCACzCC,WAAwB,EACxBpB,oBAA+D,OAA/DqB,WAA+D,mBAA5CP,cAAK,CAACI,IAAI,CAACI,QAAQ,kCACtCC,WAAwB,EACxBvB,oBAA2C,OAA3CwB,WAA2C,mBAAtBV,sBAAa,kBAClCW,WAAwB,EACxBzB,oBAKM,OALN0B,WAKM,GAJJC,WAA0B,EAC1B3B,oBAA4F;IAAzFD,KAAK,mBAAC,eAAe;MAAA,sBAAiC6B;IAAW;sBAAOA,gBAAU,yBACrFC,WACK,sBAAuC,KAAvCC,WAAuC,mBAAXF,UAAI,sBAGzCG,WAAI,EACJ/B,oBAiBM,OAjBNgC,WAiBM,GAhBJvB,aAOkBwB;sBALd,MAAyB,oBAD3B5B,oBAKE6B,6BAJiBN,aAAO,EAAjBO,MAAM;2BADfC,aAKEC;QAHCC,EAAE,EAAEH,MAAM,CAACI,SAAS;QACpBC,KAAK,EAAEL,MAAM,CAACK,KAAK;oBACJL,MAAM,CAACK,KAAK;yCAAZL,MAAM,CAACK,KAAK;wBAA5B;UAAAC;QAAA;;;;;MAGFzC,oBAMM,OANN0C,WAMM,GALJ1C,oBAG8C;IAF3CW,OAAK,sCAAEiB,cAAQ,IAAIA,cAAQ;IAC5B7B,KAAK,mBAAC,QAAQ;MAAA,gBACY6B;IAAQ;2BACpC5B,oBAAoD,WAAjD,aAAW,oBAAG4B,cAAQ,gBAAe,UAAQ,mBAEpDnB,aAAgFkC;IAAhEhC,OAAK,EAAEG;EAAW;sBAAE,MAA4B,CAA5B8B,WAA4B","names":["_imports_0","class","_createElementVNode","src","alt","_hoisted_5","_hoisted_6","_createElementBlock","_hoisted_1","_hoisted_2","_hoisted_3","_createVNode","_component_y_left_arrow_button","onClick","_ctx","_hoisted_4","$options","block_title","_hoisted_8","_hoisted_9","user","login","_hoisted_10","_hoisted_11","jetBotId","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","$data","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_component_y_results_tabel","_Fragment","metric","_createBlock","_component_y_results_tabel_item","id","metric_id","value","number","_hoisted_21","_component_y_cool_button","_hoisted_22"],"sourceRoot":"","sources":["/home/yan/Документы/psyreply2.0_front/admin/src/components/Results/YDashboard.vue"],"sourcesContent":["<template>\n  <div class=\"dashboard\">\n    <header class=\"header\">\n      <div class=\"header__select\">\n        <y-left-arrow-button @click=\"$emit('close')\" />\n        <h1 class=\"heading header__heading\">{{ block.block_title }}</h1>\n      </div>\n\n        <div @click=\"openClientDash\" class=\"dash__button\">\n          <div class=\"dash__button__title\">Дашборд</div>\n          <img src=\"@/assets/img/dash.svg\" alt=\"\">\n        </div>\n    </header>\n    <div class=\"user\">\n      <div class=\"username\">{{ block.user.login || 'no username' }}</div>\n      <div class=\"line\"></div>\n      <div class=\"id\">{{ block.user.jetBotId || 'no user id' }}</div>\n      <div class=\"line\"></div>\n      <div class=\"date\">{{ formattedDate }}</div>\n      <div class=\"line\"></div>\n      <div class=\"passage\">\n        <p>Время прохождения: </p>\n        <p class=\"passage__user\" :class=\"{ 'passage__user_bad': !isTimeValid }\">{{ timeOnPass }}</p>\n        <span class=\"slash\"> /\n      </span><p class=\"passage__test\">{{ time }}</p>\n      </div>\n    </div>\n    <hr>\n    <div class=\"results__button\">\n      <y-results-tabel>\n        <y-results-tabel-item\n          v-for=\"metric of metrics\"\n          :id=\"metric.metric_id\"\n          :value=\"metric.value\"\n          v-model.number=\"metric.value\"\n        />\n      </y-results-tabel>\n        <div class=\"results__valid\">\n          <div\n            @click=\"approved = !approved\"\n            class=\"elipce\"\n            :class=\"{ 'elipse__bad': !approved }\"></div>\n          <p>Результаты {{ approved ? \"\" : \"не\" }} валидны</p>\n        </div>\n      <y-cool-button @click=\"updateBlock\"><h1>Сохранить изменения</h1></y-cool-button>\n    </div>\n\n  </div>\n</template>\n\n<script>\nimport Results from '@/api/admin/Results';\nimport User from \"@/api/admin/User\";\n\nexport default {\n  name: \"YDashboard\",\n  created() {\n    this.metrics = JSON.parse(this.block.data)\n    this.approved = this.block.approved\n\n    if (this.block.block.time > 0) {\n      let hours = Math.floor(this.block.block.time / (60 * 60 * 1000))\n      hours = (hours < 10) ? `0${hours}` : hours\n      this.block.block.time -= hours * 60 * 60 * 1000\n      let minutes = Math.floor(this.block.block.time / (60 * 1000))\n      minutes = (minutes < 10) ? `0${minutes}` : minutes\n      this.block.block.time -= minutes * 60 * 1000\n      let seconds = Math.floor(this.block.block.time / 1000)\n      seconds = (seconds < 10) ? `0${seconds}` : seconds\n\n      this.time = `${hours}:${minutes}:${seconds}`\n    } else {\n      this.time = 'нет временных рамок'\n    }\n    // this.time = this.block.time_on_pass\n\n    if (this.block.time_on_pass > 0) {\n      let hours = Math.floor(this.block.time_on_pass / (60 * 60 * 1000))\n      hours = (hours < 10) ? `0${hours}` : hours\n      this.block.time_on_pass -= hours * 60 * 60 * 1000\n      let minutes = Math.floor(this.block.time_on_pass / (60 * 1000))\n      this.block.time_on_pass -= minutes * 60 * 1000\n      let seconds = Math.floor(this.block.time_on_pass / 1000)\n      seconds = (seconds < 10) ? `0${seconds}` : seconds\n      this.block.time_on_pass -= seconds * 1000\n      const ms = this.block.time_on_pass / 1000\n      if (ms >= 5000) {\n        seconds += 1\n      }\n      minutes = (minutes < 10) ? `0${minutes}` : minutes\n      this.timeOnPass = `${hours}:${minutes}:${seconds}`\n    } else {\n      this.timeOnPass = 0\n    }\n    this.isTimeValid = this.timeOnPass < this.time;\n  },\n  data() {\n    return {\n      metrics: [],\n      approved: null,\n      time: null,\n      timeOnPass: null,\n      isTimeValid: true\n    }\n  },\n  methods: {\n    updateBlock() {\n      const body = {\n        newData: this.metrics,\n        approved: this.approved\n      }\n\n      const results = new Results()\n      results.update(this.block.id, body)\n        .then(res => {\n          if (res.ok) {\n            this.$store.commit('openPopup', 'Данные сохранены')\n          } else {\n            this.$store.commit('openErrorPopup', res.msg())\n          }\n        })\n    },\n    async openClientDash() {\n      const client = new User();\n      const link = await client.getDashLink(this.$store.getters.editBlock.user.jetBotId).then(res => res.text());\n      window.open(link, \"_blank\")\n    }\n  },\n  computed: {\n    block() {\n      return this.$store.getters.editBlock\n    },\n    formattedDate() {\n      let date = new Date(this.block.createdAt)\n      const day = (date.getDate() < 10) ? `0${date.getDate()}` : date.getDate()\n      const month = (date.getMonth() + 1 < 10) ? `0${date.getMonth() + 1}` : date.getMonth() + 1\n      const year = date.getFullYear()\n\n      return `${day}/${month}/${year}`\n    },\n  }\n}\n</script>\n\n<style scoped>\n.dash__button{\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: center;\n  background: rgba(255, 255, 255, 0.16);\n  border-radius: 14px;\n  padding: 1rem;\n  cursor: pointer;\n}\n.dash__button__title{\n  margin-right: 0.5rem;\n}\n.header{\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: space-between;\n}\n.header__select{\n  display: grid;\n  grid-template-columns: auto max-content;\n  justify-content: left;\n  grid-gap: 1rem;\n}\n.user{\n  display: flex;\n  align-items: center;\n  justify-content: left;\n  opacity: 0.5;\n\n}\n.line{\n  margin-left: 0.5rem;\n  margin-right: 0.5rem;\n  background-color: rgba(255, 255, 255, 0.36);\n  height: 2rem;\n  width: 2px;\n  justify-self: center;\n\n}\n.slash{\n  margin-left: 0.5rem;\n  margin-right: 0.5rem;\n}\n\ntable{\n  width: 100%;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.26);\n  border-top: 1px solid rgba(255, 255, 255, 0.26);\n\n}\nhr {\n  margin-bottom: 1rem;\n  min-width: 30vh;\n  border-left: 0px solid white;\n  border-right: 0px solid white;\n  border-bottom: 0px solid white;\n  border-top: 1px solid rgba(255, 255, 255, 0.52);\n\n}\n.results__button{\n  display: grid;\n  grid-template-rows: 1fr 1rem 4rem;\n  grid-gap: 3rem;\n}\n.passage{\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n\n}\n.passage__user{\n  margin-left: 0.5rem;\n  color: rgba(0, 255, 25, 0.66);\n\n}\n.passage__user_bad{\n  color:red;\n}\n\n.elipce{\n  background: linear-gradient(200.42deg, #38F9D7 13.57%, #43E97B 98.35%);\n  width: 0.7rem;\n  height: 0.7rem;\n  border-radius: 50%;\n  margin-right: 0.5rem;\n}\n.elipse__bad {\n  background: linear-gradient(200.42deg, #f93838 13.57%, #e94343 98.35%);\n}\n.results__valid{\n  display: flex;\n  align-items: center;\n}\n\n</style>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}