{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport Block from '@/api/admin/Block';\nimport YCoolButton from '@/components/UI/YCoolButton';\nimport Test from '@/api/admin/Test';\nimport YPopupWarn from \"@/components/UI/YPopupWarn\";\nimport mainConf, { ProjectState } from \"../../../../main.conf\";\nfunction update(data) {\n  const block = new Block();\n  block.get(data.id).then(res => {\n    if (res.ok) {\n      res.json().then(res => {\n        const r = res.body;\n        data.block = r;\n        data.block.week = parseInt(data.block.week);\n        const hours = Math.floor(r.time / (60 * 60 * 1000));\n        r.time -= hours * 60 * 60 * 1000;\n        const minutes = Math.floor(r.time / (60 * 1000));\n        r.time -= minutes * 60 * 1000;\n        const seconds = Math.floor(r.time / 1000);\n        data.newTime = {\n          hours,\n          minutes,\n          seconds\n        };\n      });\n    } else {\n      this.$store.commit('openErrorPopup', res.msg());\n    }\n  });\n  const test = new Test();\n  test.getAll({\n    filters: {\n      \"except_block\": data.id\n    }\n  }).then(res => {\n    if (res.ok) {\n      res.json().then(r => data.tests = r.body);\n    } else {\n      this.$store.commit('openErrorPopup', res.msg());\n      if (mainConf.projectState === ProjectState.dev) console.log(res);\n    }\n  });\n}\nexport default {\n  name: \"EditBlock\",\n  components: {\n    YCoolButton,\n    YPopupWarn\n  },\n  props: ['id'],\n  data() {\n    return {\n      tests: [],\n      block: {\n        tests: []\n      },\n      newTime: {\n        hours: null,\n        minutes: null,\n        seconds: null\n      }\n    };\n  },\n  created() {\n    update(this);\n  },\n  methods: {\n    async generateBlockToken() {\n      const block = new Block();\n      await block.generateToken(this.block).then(res => {\n        window.prompt(\"Нажмите Ctrl+C\", JSON.parse(res).body);\n      });\n    },\n    update() {\n      update(this);\n    },\n    selectAddTest(n) {\n      if (mainConf.projectState === ProjectState.dev) console.log(n);\n      //this.block.tests.forEach(el => el.active = false)\n      let test = this.block.tests.filter(el => el.id === n.id);\n      test = test[0];\n      if ('active' in test) {\n        test.active = !test.active;\n      } else {\n        test['active'] = true;\n      }\n    },\n    selectRemoveTest(n) {\n      if (mainConf.projectState === ProjectState.dev) console.log(n);\n      //this.tests.forEach(el => el.active = false)\n      let test = this.tests.filter(el => el.id === n.id);\n      test = test[0];\n      if ('active' in test) {\n        test.active = !test.active;\n      } else {\n        test['active'] = true;\n      }\n    },\n    removeTests() {\n      const test = new Test();\n      const removeTests = this.block.tests.filter(el => el.active);\n      if (removeTests.length === 0) {\n        return this.$store.commit('openErrorPopup', 'Выберите тест для добавления');\n      }\n      const body = {\n        tests: []\n      };\n      removeTests.forEach(el => body.tests.push(el.id));\n      test.removeFromBlock(this.id, body).then(res => {\n        if (res.ok) {\n          this.$store.commit('openPopup', `Тесты успешно удалены из ${this.block.name}`);\n          this.update();\n        } else {\n          this.$store.commit('closeErrorPopup', res.msg());\n        }\n      });\n    },\n    addTests() {\n      const test = new Test();\n      const addTests = this.tests.filter(el => el.active);\n      if (addTests.length === 0) {\n        return this.$store.commit('openErrorPopup', 'Выберите тест для добавления');\n      }\n      const body = {\n        tests: []\n      };\n      addTests.forEach(el => body.tests.push(el.id));\n      test.addToBlock(this.id, body).then(res => {\n        if (res.ok) {\n          this.$store.commit('openPopup', `Тесты добавлены в ${this.block.name}`);\n          this.update();\n        } else {\n          this.$store.commit('openErrorPopup', res.msg());\n        }\n      });\n    },\n    updateBlock() {\n      if (this.block.name.length < 1) {\n        return this.$store.commit('openErrorPopup', 'Название слишком короткое');\n      }\n      let time = 0;\n      time += this.newTime.hours * 60 * 60 * 1000;\n      time += this.newTime.minutes * 60 * 1000;\n      time += this.newTime.seconds * 1000;\n      const block = new Block();\n      const body = {\n        name: this.block.name,\n        time\n      };\n      block.update(this.id, body).then(res => {\n        if (res.ok) {\n          this.$store.commit('openPopup', 'Блок успешно сохранен');\n          this.update();\n        } else {\n          this.$store.commit('openErrorPopup', res.msg());\n        }\n      });\n    },\n    removeBlock() {\n      this.$store.commit('openWarnPopup', {\n        message: \"Вы уверены, что хотите удалить блок? (Удаление блока НЕ повлечёт за собой удаление тестов внутри него)\",\n        acceptCallback: () => {\n          const block = new Block();\n          const body = {\n            blocks: [this.id]\n          };\n          block.remove(body).then(res => {\n            if (res.ok) {\n              this.$store.commit('openPopup', \"Блок успешно удален!\");\n              this.$emit('close');\n            } else {\n              this.$store.commit('openErrorPopup', res.msg);\n            }\n          });\n        }\n      });\n    }\n  }\n};","map":{"version":3,"mappings":"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","names":["Block","YCoolButton","Test","YPopupWarn","mainConf","ProjectState","update","data","block","get","id","then","res","ok","json","r","body","week","parseInt","hours","Math","floor","time","minutes","seconds","newTime","$store","commit","msg","test","getAll","filters","tests","projectState","dev","console","log","name","components","props","created","methods","generateBlockToken","generateToken","window","prompt","JSON","parse","selectAddTest","n","filter","el","active","selectRemoveTest","removeTests","length","forEach","push","removeFromBlock","addTests","addToBlock","updateBlock","removeBlock","message","acceptCallback","blocks","remove","$emit"],"sourceRoot":"","sources":["/home/yan/Документы/psyreply2.0_front/admin/src/components/Block/EditBlock.vue"],"sourcesContent":["<template>\n  <y-modal class=\"modal\">\n    <header class=\"header\">\n      <y-left-arrow-button @click=\"$emit('close')\" />\n      <h1 class=\"heading\">Редактирование: {{ block.name }}</h1>\n      <template v-if=\"block.company_id != null\">\n        <y-button :plus=\"true\" @click=\"generateBlockToken()\">Сгенерировать токен</y-button>\n        <y-input max=\"1000\" min=\"0\" v-model.trim=\"block.week\" type=\"number\" />\n      </template>\n    </header>\n\n    <y-modal>\n      <header class=\"header\">\n        <h2 class=\"heading\">Изменение параметров {{ block.name }}</h2>\n      </header>\n      <y-input v-model.trim=\"block.name\" />\n      <y-modal class=\"time-picker\">Время на прохождение -\n        <y-input max=\"99\" min=\"0\" type=\"number\" v-model=\"newTime.hours\" placeholder=\"чч\" class=\"time-picker__input\"/>:\n        <y-input max=\"59\" min=\"0\" type=\"number\" v-model=\"newTime.minutes\" placeholder=\"мм\" class=\"time-picker__input\"/>:\n        <y-input max=\"59\" min=\"0\" type=\"number\" v-model=\"newTime.seconds\" placeholder=\"сс\" class=\"time-picker__input\"/>\n      </y-modal>\n      <y-cool-button @click=\"updateBlock\">Сохранить обновленный {{ block.name }}</y-cool-button>\n    </y-modal>\n\n    <y-modal v-if=\"block.tests.length > 0\">\n      <header class=\"header\">\n        <h2 class=\"heading\">Редактирование тестов блока</h2>\n      </header>\n      <y-list\n        v-if=\"block.tests.length > 0\"\n        key-of-name=\"title\"\n        :items=\"block.tests\"\n        :selectable=\"true\"\n        @select=\"selectAddTest\"\n      />\n      <y-cool-button @click=\"removeTests\">Удалить тест из блока</y-cool-button>\n    </y-modal>\n\n    <y-modal v-if=\"tests.length > 0\">\n      <header class=\"header\">\n        <h2 class=\"heading\">Добавление тестов в блок</h2>\n      </header>\n      <y-list\n        :selectable=\"true\"\n        @select=\"selectRemoveTest\"\n        :items=\"tests\"\n        key-of-name=\"title\"\n      />\n      <y-cool-button @click=\"addTests\">Добавить в блок</y-cool-button>\n    </y-modal>\n    <y-modal>\n      <header class=\"header\">\n        <h2 class=\"heading\">Опасная зона</h2>\n      </header>\n      <y-cool-button @click=\"removeBlock\">Удалить блок</y-cool-button>\n    </y-modal>\n\n  </y-modal>\n</template>\n\n<script>\nimport Block from '@/api/admin/Block';\nimport YCoolButton from '@/components/UI/YCoolButton';\nimport Test from '@/api/admin/Test';\nimport YPopupWarn from \"@/components/UI/YPopupWarn\";\nimport mainConf, {ProjectState} from \"../../../../main.conf\";\n\nfunction update(data) {\n  const block = new Block()\n  block.get(data.id)\n    .then(res => {\n      if (res.ok) {\n        res.json().then(res => {\n          const r = res.body;\n          data.block = r\n          data.block.week = parseInt(data.block.week)\n\n          const hours = Math.floor(r.time / (60 * 60 * 1000))\n          r.time -= hours * 60 * 60 * 1000\n          const minutes = Math.floor(r.time / (60 * 1000))\n          r.time -= minutes * 60 * 1000\n          const seconds = Math.floor(r.time / 1000)\n\n          data.newTime = { hours, minutes, seconds }\n        })\n      } else {\n        this.$store.commit('openErrorPopup', res.msg())\n      }\n    })\n\n  const test = new Test()\n  test.getAll({ filters: { \"except_block\": data.id } })\n    .then(res => {\n      if (res.ok) {\n        res.json().then(r => data.tests = r.body)\n      } else {\n        this.$store.commit('openErrorPopup', res.msg())\n        if (mainConf.projectState === ProjectState.dev)\n          console.log(res)\n      }\n    })\n}\n\nexport default {\n  name: \"EditBlock\",\n  components: {YCoolButton, YPopupWarn},\n\n  props: ['id'],\n  data() {\n    return {\n      tests: [],\n      block: {\n        tests: [],\n      },\n      newTime: {\n        hours: null,\n        minutes: null,\n        seconds: null\n      }\n    }\n  },\n  created() {\n    update(this)\n  },\n  methods: {\n    async generateBlockToken() {\n      const block = new Block();\n      await block.generateToken(this.block).then(res => {\n        window.prompt(\"Нажмите Ctrl+C\", JSON.parse(res).body);\n      });\n    },\n    update() {\n      update(this)\n    },\n    selectAddTest(n) {\n      if (mainConf.projectState === ProjectState.dev)\n        console.log(n)\n      //this.block.tests.forEach(el => el.active = false)\n      let test = this.block.tests.filter(el => el.id === n.id)\n      test = test[0]\n      if ('active' in test) {\n        test.active = !test.active\n      } else {\n        test['active'] = true\n      }\n    },\n    selectRemoveTest(n) {\n      if (mainConf.projectState === ProjectState.dev)\n        console.log(n)\n      //this.tests.forEach(el => el.active = false)\n      let test = this.tests.filter(el => el.id === n.id)\n      test = test[0]\n      if ('active' in test) {\n        test.active = !test.active\n      } else {\n        test['active'] = true\n      }\n    },\n    removeTests() {\n      const test = new Test()\n\n      const removeTests = this.block.tests.filter(el => el.active)\n\n      if (removeTests.length === 0) {\n        return this.$store.commit('openErrorPopup', 'Выберите тест для добавления')\n      }\n\n      const body = {\n        tests: []\n      }\n\n      removeTests.forEach(el => body.tests.push(el.id))\n\n      test.removeFromBlock(this.id, body)\n        .then(res => {\n          if (res.ok) {\n            this.$store.commit('openPopup', `Тесты успешно удалены из ${this.block.name}`)\n            this.update()\n          } else {\n            this.$store.commit('closeErrorPopup', res.msg())\n          }\n        })\n    },\n    addTests() {\n      const test = new Test()\n\n      const addTests = this.tests.filter(el => el.active)\n\n      if (addTests.length === 0) {\n        return this.$store.commit('openErrorPopup', 'Выберите тест для добавления')\n      }\n\n      const body = {\n        tests: []\n      }\n\n      addTests.forEach(el => body.tests.push(el.id))\n\n      test.addToBlock(this.id, body)\n        .then(res => {\n          if (res.ok) {\n            this.$store.commit('openPopup', `Тесты добавлены в ${this.block.name}`)\n            this.update()\n          } else {\n            this.$store.commit('openErrorPopup', res.msg())\n          }\n        })\n    },\n    updateBlock() {\n      if (this.block.name.length < 1) {\n        return this.$store.commit('openErrorPopup', 'Название слишком короткое')\n      }\n\n      let time = 0\n\n      time += this.newTime.hours * 60 * 60 * 1000\n      time += this.newTime.minutes * 60 * 1000\n      time += this.newTime.seconds * 1000\n\n      const block = new Block()\n      const body = {\n        name: this.block.name,\n        time\n      }\n      block.update(this.id, body)\n        .then(res=> {\n          if (res.ok) {\n            this.$store.commit('openPopup', 'Блок успешно сохранен')\n            this.update()\n          } else {\n            this.$store.commit('openErrorPopup', res.msg())\n          }\n        })\n    },\n    removeBlock() {\n      this.$store.commit('openWarnPopup', { message: \"Вы уверены, что хотите удалить блок? (Удаление блока НЕ повлечёт за собой удаление тестов внутри него)\", acceptCallback: () => {\n        const block = new Block()\n\n        const body = {\n          blocks: [this.id]\n        }\n\n        block.remove(body)\n            .then(res => {\n              if (res.ok) {\n                this.$store.commit('openPopup', \"Блок успешно удален!\")\n                this.$emit('close')\n              } else {\n                this.$store.commit('openErrorPopup', res.msg)\n              }\n            })\n      }})\n    }\n  }\n}\n</script>\n\n<style scoped>\n.modal {\n  display: grid;\n  grid-gap: 1rem;\n}\n.header {\n  display: grid;\n  grid-template-columns: auto 1fr min-content min-content;\n  grid-gap: 2rem;\n  justify-content: start;\n  align-items: center;\n}\n.time-picker {\n  font-size: 1.2rem;\n  padding: .2rem 1rem;\n  display: grid;\n  grid-template-columns: min-content repeat(3, 3.3rem min-content);\n  align-items: center;\n  grid-gap: .1rem;\n  white-space: nowrap;\n}\n.time-picker__input {\n  padding: .1rem;\n}\n</style>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}