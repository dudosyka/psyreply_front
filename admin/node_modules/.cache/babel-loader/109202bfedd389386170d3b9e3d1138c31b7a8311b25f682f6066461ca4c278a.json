{"ast":null,"code":"import { resolveComponent as _resolveComponent, createVNode as _createVNode, createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, createTextVNode as _createTextVNode, withCtx as _withCtx, openBlock as _openBlock, createBlock as _createBlock, Fragment as _Fragment, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-24cd7308\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"wrapper\"\n};\nconst _hoisted_2 = {\n  class: \"main\"\n};\nconst _hoisted_3 = {\n  class: \"header\"\n};\nconst _hoisted_4 = {\n  class: \"header__select\"\n};\nconst _hoisted_5 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"heading header__heading\"\n}, \"Блоки\", -1 /* HOISTED */));\n\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_y_popup_warn = _resolveComponent(\"y-popup-warn\");\n  const _component_y_left_side_bar = _resolveComponent(\"y-left-side-bar\");\n  const _component_y_select = _resolveComponent(\"y-select\");\n  const _component_y_button = _resolveComponent(\"y-button\");\n  const _component_y_list = _resolveComponent(\"y-list\");\n  const _component_y_modal = _resolveComponent(\"y-modal\");\n  const _component_create_block = _resolveComponent(\"create-block\");\n  const _component_edit_block = _resolveComponent(\"edit-block\");\n  return _openBlock(), _createElementBlock(_Fragment, null, [_createVNode(_component_y_popup_warn), _createElementVNode(\"div\", _hoisted_1, [_createVNode(_component_y_left_side_bar), _createElementVNode(\"main\", _hoisted_2, [$data.window === 'main' ? (_openBlock(), _createBlock(_component_y_modal, {\n    key: 0,\n    class: \"main__modal\"\n  }, {\n    default: _withCtx(() => [_createElementVNode(\"header\", _hoisted_3, [_createElementVNode(\"div\", _hoisted_4, [_hoisted_5, _createCommentVNode(\"            <select style=\\\"color: white\\\" v-model=\\\"filter\\\" @change=\\\"updateBlocksList\\\">\\n              <option style=\\\"color: black\\\" :value=\\\"null\\\">Без фильтра</option>\\n              <option style=\\\"color: black\\\" v-for=\\\"company of companies\\\" :value=\\\"company.id\\\">{{company.name}}</option>\\n            </select>\"), _createVNode(_component_y_select, {\n      class: \"fs-2\",\n      selects: $data.companies,\n      onSelect: $options.updateBlocksList\n    }, null, 8 /* PROPS */, [\"selects\", \"onSelect\"])]), _createVNode(_component_y_button, {\n      plus: true,\n      onClick: $options.createBlock\n    }, {\n      default: _withCtx(() => [_createTextVNode(\"Новый блок\")]),\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"onClick\"])]), _createCommentVNode(\"        U can add \\\"items\\\" props to list component. It must be array \"), _createVNode(_component_y_list, {\n      \"key-of-name\": \"name\",\n      editable: true,\n      onEdit: $options.editBlock,\n      items: $data.blocks,\n      pagination: true,\n      \"page-size\": 3\n    }, null, 8 /* PROPS */, [\"onEdit\", \"items\"])]),\n    _: 1 /* STABLE */\n  })) : _createCommentVNode(\"v-if\", true), $data.window === 'createBlock' ? (_openBlock(), _createBlock(_component_create_block, {\n    key: 1,\n    onClose: $options.close\n  }, null, 8 /* PROPS */, [\"onClose\"])) : _createCommentVNode(\"v-if\", true), $data.window === 'editBlock' ? (_openBlock(), _createBlock(_component_edit_block, {\n    key: 2,\n    id: $data.editBlockId,\n    onClose: $options.close\n  }, null, 8 /* PROPS */, [\"id\", \"onClose\"])) : _createCommentVNode(\"v-if\", true)])])], 64 /* STABLE_FRAGMENT */);\n}","map":{"version":3,"mappings":";;;EAEOA,KAAK,EAAC;AAAS;;EAEZA,KAAK,EAAC;AAAM;;EAENA,KAAK,EAAC;AAAQ;;EACfA,KAAK,EAAC;AAAgB;gEACzBC,oBAAgD;EAA3CD,KAAK,EAAC;AAAyB,GAAC,OAAK;;;;;;;;;;;6DAPpDE,aAA6BC,0BAC7BF,oBAuCM,OAvCNG,UAuCM,GAtCJF,aAAmBG,6BACnBJ,oBAoCO,QApCPK,UAoCO,GAnCUC,YAAM,6BAArBC,aAyBUC;;IAzBwBT,KAAK,EAAC;;sBACtC,MAcS,CAdTC,oBAcS,UAdTS,UAcS,GAbPT,oBAWM,OAXNU,UAWM,GAVJC,UAAgD,EAC5DC,yVAGwB,EACZX,aAIEY;MAHEd,KAAK,EAAC,MAAM;MACbe,OAAO,EAAER,eAAS;MAClBS,QAAM,EAAEC;wDAGbf,aAAiEgB;MAAtDC,IAAI,EAAE,IAAI;MAAGC,OAAK,EAAEH;;wBAAa,MAAU,kBAAV,YAAU;;sCAEhEJ,6FAA2E,EACnEX,aAOEmB;MANA,aAAW,EAAC,MAAM;MACjBC,QAAQ,EAAE,IAAI;MACdC,MAAI,EAAEN,kBAAS;MACfO,KAAK,EAAEjB,YAAM;MACbkB,UAAU,EAAE,IAAI;MAChB,WAAS,EAAE;;;2CAIRlB,YAAM,oCADdC,aAGEkB;;IADCC,OAAK,EAAEV;6EAIFV,YAAM,kCAFdC,aAIEoB;;IAHCC,EAAE,EAAEtB,iBAAW;IAEfoB,OAAK,EAAEV","names":["class","_createElementVNode","_createVNode","_component_y_popup_warn","_hoisted_1","_component_y_left_side_bar","_hoisted_2","$data","_createBlock","_component_y_modal","_hoisted_3","_hoisted_4","_hoisted_5","_createCommentVNode","_component_y_select","selects","onSelect","$options","_component_y_button","plus","onClick","_component_y_list","editable","onEdit","items","pagination","_component_create_block","onClose","_component_edit_block","id"],"sourceRoot":"","sources":["/home/yan/Документы/psyreply2.0_front/admin/src/views/BlockView.vue"],"sourcesContent":["<template>\n  <y-popup-warn></y-popup-warn>\n  <div class=\"wrapper\">\n    <y-left-side-bar />\n    <main class=\"main\">\n      <y-modal v-if=\"window === 'main'\" class=\"main__modal\">\n        <header class=\"header\">\n          <div class=\"header__select\">\n            <div class=\"heading header__heading\">Блоки</div>\n<!--            <select style=\"color: white\" v-model=\"filter\" @change=\"updateBlocksList\">\n              <option style=\"color: black\" :value=\"null\">Без фильтра</option>\n              <option style=\"color: black\" v-for=\"company of companies\" :value=\"company.id\">{{company.name}}</option>\n            </select>-->\n            <y-select\n                class=\"fs-2\"\n              :selects=\"companies\"\n              @select=\"updateBlocksList\"\n            />\n          </div>\n          <y-button :plus=\"true\" @click=\"createBlock\">Новый блок</y-button>\n        </header>\n<!--        U can add \"items\" props to list component. It must be array -->\n        <y-list\n          key-of-name=\"name\"\n          :editable=\"true\"\n          @edit=\"editBlock\"\n          :items=\"blocks\"\n          :pagination=\"true\"\n          :page-size=\"3\"\n        />\n      </y-modal>\n      <create-block\n        v-if=\"window === 'createBlock'\"\n        @close=\"close\"\n      />\n      <edit-block\n        :id=\"editBlockId\"\n        v-if=\"window === 'editBlock'\"\n        @close=\"close\"\n      />\n    </main>\n  </div>\n</template>\n\n<script>\nimport CreateBlock from '@/components/Block/CreateBlock';\nimport EditBlock from '@/components/Block/EditBlock';\n\nimport Block from '@/api/admin/Block';\nimport Company from '@/api/admin/Company';\nimport YPopupWarn from \"@/components/UI/YPopupWarn\";\n\nfunction update(data) {\n  const block = new Block()\n  block.getAll({filters: { company_id: data.filter }})\n    .then(res => {\n      if (res.ok) {\n        res.json().then(data => data.body).then(r => data.blocks = r)\n      }\n    })\n}\n\nexport default {\n  name: \"BlockView\",\n  components: {\n    YPopupWarn,\n    CreateBlock, EditBlock\n  },\n  data() {\n    return {\n      window: 'main',\n      blocks: [],\n      editBlockId: null,\n      companies: [],\n      filter: null\n    }\n  },\n  created() {\n    this.$watch(\n        () => this.$route.params,\n        (toParams, previousParams) => {\n          if (toParams.after === '')\n            this.window = 'main'\n        }\n    )\n    update(this)\n    const company = new Company()\n    this.companies.push({ })\n    this.companies.forEach(el => el['active'] = false)\n    this.companies[0]['name'] = 'Шаблоны'\n    this.companies[0]['id'] = null\n    this.companies[0]['active'] = true\n    company.getAllCompanies()\n      .then(res => {\n        if (res.ok) {\n          res.json().then(data => data.body).then(r => {\n            r.forEach(el => {\n              el.active = false\n              this.companies.push(el)\n            })\n          })\n        }\n      })\n  },\n  methods: {\n    editBlock(n){\n      this.$router.push('/block/edit')\n      this.window = 'editBlock'\n      this.editBlockId = n.id\n    },\n    createBlock() {\n      this.$router.push('/block/create')\n      this.window = 'createBlock'\n    },\n    updateBlocksList(n) {\n      this.companies.map(el => {\n        el.active = el.id === n.id;\n      })\n      const select = this.companies.filter(el => el.active)\n      this.filter = select[0].id\n      update(this)\n    },\n    close() {\n      this.$router.push('/block')\n      this.window = 'main'\n\n      this.companies.map(el => el.active = false)\n      this.companies.map(el => {\n        el.active = el.id === null;\n      })\n      this.filter = null\n      update(this)\n    },\n  }\n}\n</script>\n\n<style scoped>\n.wrapper {\n  display: grid;\n  grid-template-columns: min-content 1fr;\n  width: 100%;\n}\n\n.main {\n  padding: 4.125rem;\n}\n.main__modal {\n  display: grid;\n  grid-gap: 2.5625rem;\n}\n\n.header {\n  display: grid;\n  grid-template-columns: auto min-content;\n}\n.header__select{\n  cursor: pointer;\n  display: flex;\n  flex-direction: row;\n  align-items: baseline;\n  justify-content: left;\n\n}\n\n\n.header__heading{\n  margin-right: 0.5rem;\n\n  font-size:2rem;\n}\n.header__arrow__button img{\n  width: 26px;\n  height: 26px;\n  margin-right: 20px;\n  cursor: pointer;\n}\n\n.fs-2 {\n  font-size: 1.3rem;\n}\n\n</style>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}